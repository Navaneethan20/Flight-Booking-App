{"ast":null,"code":"import axios from'axios';import React,{useEffect,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const FlightBookings=()=>{const[userDetails,setUserDetails]=useState();useEffect(()=>{fetchUserData();},[]);const fetchUserData=async()=>{try{const id=localStorage.getItem('userId');await axios.get(`https://flight-booking-mern-webapp.onrender.com/fetch-user/${id}`).then(response=>{setUserDetails(response.data);console.log(response.data);});}catch(err){}};const[bookings,setBookings]=useState([]);useEffect(()=>{fetchBookings();},[]);const fetchBookings=async()=>{await axios.get('https://flight-booking-mern-webapp.onrender.com/fetch-bookings').then(response=>{setBookings(response.data.reverse());});};const cancelTicket=async id=>{await axios.put(`https://flight-booking-mern-webapp.onrender.com/cancel-ticket/${id}`).then(response=>{alert(\"Ticket cancelled!!\");fetchBookings();});};return/*#__PURE__*/_jsx(\"div\",{className:\"user-bookingsPage\",children:userDetails?/*#__PURE__*/_jsx(_Fragment,{children:userDetails.approval==='not-approved'?/*#__PURE__*/_jsxs(\"div\",{className:\"notApproved-box\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Approval Required!!\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Your application is under processing. It needs an approval from the administrator. Kindly please be patience!!\"})]}):userDetails.approval==='approved'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Bookings\"}),/*#__PURE__*/_jsx(\"div\",{className:\"user-bookings\",children:bookings.filter(booking=>booking.flightName===localStorage.getItem('username')).map(booking=>{return/*#__PURE__*/_jsxs(\"div\",{className:\"user-booking\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Booking ID:\"}),\" \",booking._id]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Mobile:\"}),\" \",booking.mobile]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Email:\"}),\" \",booking.email]})]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Flight Id:\"}),\" \",booking.flightId]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Flight name:\"}),\" \",booking.flightName]})]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"On-boarding:\"}),\" \",booking.departure]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Destination:\"}),\" \",booking.destination]})]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"b\",{children:\"Passengers:\"})}),/*#__PURE__*/_jsx(\"ol\",{children:booking.passengers.map((passenger,i)=>{return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Name:\"}),\" \",passenger.name,\",  \",/*#__PURE__*/_jsx(\"b\",{children:\"Age:\"}),\" \",passenger.age]})},i);})})]}),booking.bookingStatus==='confirmed'?/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Seats:\"}),\" \",booking.seats]}):\"\"]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Booking date:\"}),\" \",booking.bookingDate.slice(0,10)]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Journey date:\"}),\" \",booking.journeyDate.slice(0,10)]})]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Journey Time:\"}),\" \",booking.journeyTime]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Total price:\"}),\" \",booking.totalPrice]})]}),booking.bookingStatus==='cancelled'?/*#__PURE__*/_jsxs(\"p\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"b\",{children:\"Booking status:\"}),\" \",booking.bookingStatus]}):/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Booking status:\"}),\" \",booking.bookingStatus]}),booking.bookingStatus==='confirmed'?/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:()=>cancelTicket(booking._id),children:\"Cancel Ticket\"})}):/*#__PURE__*/_jsx(_Fragment,{})]},booking._id);})})]}):\"\"}):\"\"});};export default FlightBookings;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}