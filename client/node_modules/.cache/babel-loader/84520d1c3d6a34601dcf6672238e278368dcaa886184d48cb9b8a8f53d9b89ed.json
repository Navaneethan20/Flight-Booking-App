{"ast":null,"code":"import axios from'axios';import React,{useEffect,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const FlightBookings=()=>{const[userDetails,setUserDetails]=useState();useEffect(()=>{fetchUserData();},[]);const fetchUserData=async()=>{try{const id=localStorage.getItem('userId');await axios.get(`https://flight-booking-mern-webapp.onrender.com/fetch-user/${id}`).then(response=>{setUserDetails(response.data);console.log(response.data);});}catch(err){}};const[bookings,setBookings]=useState([]);useEffect(()=>{fetchBookings();},[]);const fetchBookings=async()=>{await axios.get('https://flight-booking-mern-webapp.onrender.com/fetch-bookings').then(response=>{setBookings(response.data.reverse());});};const cancelTicket=async id=>{await axios.put(`https://flight-booking-mern-webapp.onrender.com/cancel-ticket/${id}`).then(response=>{alert(\"Ticket cancelled!!\");fetchBookings();});};return/*#__PURE__*/_jsx(\"div\",{className:\"user-bookingsPage\",children:userDetails?/*#__PURE__*/_jsx(_Fragment,{children:userDetails.approval==='not-approved'?/*#__PURE__*/_jsxs(\"div\",{className:\"notApproved-box\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Approval Required!!\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Your application is under processing. It needs an approval from the administrator. Kindly please be patience!!\"})]}):userDetails.approval==='approved'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Bookings\"}),/*#__PURE__*/_jsx(\"div\",{className:\"user-bookings\",children:bookings.filter(booking=>booking.flightName===localStorage.getItem('username')).map(booking=>{return/*#__PURE__*/_jsxs(\"div\",{className:\"user-booking\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Booking ID:\"}),\" \",booking._id]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Mobile:\"}),\" \",booking.mobile]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Email:\"}),\" \",booking.email]})]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Flight Id:\"}),\" \",booking.flightId]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Flight name:\"}),\" \",booking.flightName]})]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"On-boarding:\"}),\" \",booking.departure]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Destination:\"}),\" \",booking.destination]})]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"b\",{children:\"Passengers:\"})}),/*#__PURE__*/_jsx(\"ol\",{children:booking.passengers.map((passenger,i)=>{return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Name:\"}),\" \",passenger.name,\",  \",/*#__PURE__*/_jsx(\"b\",{children:\"Age:\"}),\" \",passenger.age]})},i);})})]}),booking.bookingStatus==='confirmed'?/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Seats:\"}),\" \",booking.seats]}):\"\"]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Booking date:\"}),\" \",booking.bookingDate.slice(0,10)]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Journey date:\"}),\" \",booking.journeyDate.slice(0,10)]})]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Journey Time:\"}),\" \",booking.journeyTime]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Total price:\"}),\" \",booking.totalPrice]})]}),booking.bookingStatus==='cancelled'?/*#__PURE__*/_jsxs(\"p\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"b\",{children:\"Booking status:\"}),\" \",booking.bookingStatus]}):/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Booking status:\"}),\" \",booking.bookingStatus]}),booking.bookingStatus==='confirmed'?/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:()=>cancelTicket(booking._id),children:\"Cancel Ticket\"})}):/*#__PURE__*/_jsx(_Fragment,{})]},booking._id);})})]}):\"\"}):\"\"});};export default FlightBookings;","map":{"version":3,"names":["axios","React","useEffect","useState","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","FlightBookings","userDetails","setUserDetails","fetchUserData","id","localStorage","getItem","get","then","response","data","console","log","err","bookings","setBookings","fetchBookings","reverse","cancelTicket","put","alert","className","children","approval","filter","booking","flightName","map","_id","mobile","email","flightId","departure","destination","passengers","passenger","i","name","age","bookingStatus","seats","bookingDate","slice","journeyDate","journeyTime","totalPrice","style","color","onClick"],"sources":["C:/Users/Navaneethan/Downloads/Flight-Booking-MERN-Webapp/client/src/pages/FlightBookings.jsx"],"sourcesContent":["import axios from 'axios';\r\nimport React, { useEffect, useState } from 'react'\r\n\r\nconst FlightBookings = () => {\r\n  const [userDetails, setUserDetails] = useState();\r\n\r\n  useEffect(()=>{\r\n    fetchUserData(); \r\n  }, [])\r\n\r\n  const fetchUserData = async () =>{\r\n    try{\r\n      const id = localStorage.getItem('userId');\r\n      await axios.get(`https://flight-booking-mern-webapp.onrender.com/fetch-user/${id}`).then(\r\n        (response)=>{\r\n          setUserDetails(response.data);\r\n          console.log(response.data);\r\n        }\r\n      )\r\n\r\n    }catch(err){\r\n\r\n    }\r\n  } \r\n\r\n\r\n  const [bookings, setBookings] = useState([]);\r\n\r\n\r\n  useEffect(()=>{\r\n    fetchBookings();\r\n  }, [])\r\n\r\n  const fetchBookings = async () =>{\r\n    await axios.get('https://flight-booking-mern-webapp.onrender.com/fetch-bookings').then(\r\n      (response)=>{\r\n        setBookings(response.data.reverse());\r\n      }\r\n    )\r\n  }\r\n\r\n  const cancelTicket = async (id) =>{\r\n    await axios.put(`https://flight-booking-mern-webapp.onrender.com/cancel-ticket/${id}`).then(\r\n      (response)=>{\r\n        alert(\"Ticket cancelled!!\");\r\n        fetchBookings();\r\n      }\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"user-bookingsPage\">\r\n\r\n      {userDetails ?\r\n        <>\r\n          {userDetails.approval === 'not-approved' ?\r\n            <div className=\"notApproved-box\">\r\n              <h3>Approval Required!!</h3>\r\n              <p>Your application is under processing. It needs an approval from the administrator. Kindly please be patience!!</p>\r\n            </div>\r\n\r\n          : userDetails.approval === 'approved' ?\r\n            <>\r\n              <h1>Bookings</h1>\r\n\r\n              <div className=\"user-bookings\">\r\n\r\n                {bookings.filter(booking=> booking.flightName === localStorage.getItem('username')).map((booking)=>{\r\n                  return(\r\n                    <div className=\"user-booking\" key={booking._id}>\r\n                    <p><b>Booking ID:</b> {booking._id}</p>\r\n                    <span>\r\n                      <p><b>Mobile:</b> {booking.mobile}</p>\r\n                      <p><b>Email:</b> {booking.email}</p>\r\n                    </span>\r\n                    <span>\r\n                      <p><b>Flight Id:</b> {booking.flightId}</p>\r\n                      <p><b>Flight name:</b> {booking.flightName}</p>\r\n                    </span>\r\n                    <span>\r\n                      <p><b>On-boarding:</b> {booking.departure}</p>\r\n                      <p><b>Destination:</b> {booking.destination}</p>\r\n                    </span>\r\n                    <span>\r\n                      <div>\r\n                        <p><b>Passengers:</b></p>\r\n                        <ol>\r\n                          {booking.passengers.map((passenger, i)=>{\r\n                            return(\r\n                              <li key={i}><p><b>Name:</b> {passenger.name},  <b>Age:</b> {passenger.age}</p></li>\r\n                            )\r\n                          })}\r\n                        </ol>\r\n                      </div>\r\n                      {booking.bookingStatus === 'confirmed' ? <p><b>Seats:</b> {booking.seats}</p> : \"\"}\r\n                    </span>\r\n                    <span>\r\n                      <p><b>Booking date:</b> {booking.bookingDate.slice(0,10)}</p>\r\n                      <p><b>Journey date:</b> {booking.journeyDate.slice(0,10)}</p>\r\n                    </span>\r\n                    <span>\r\n                      <p><b>Journey Time:</b> {booking.journeyTime}</p>\r\n                      <p><b>Total price:</b> {booking.totalPrice}</p>\r\n                    </span>\r\n                      {booking.bookingStatus === 'cancelled' ?\r\n                        <p style={{color: \"red\"}}><b>Booking status:</b> {booking.bookingStatus}</p>\r\n                        :\r\n                        <p><b>Booking status:</b> {booking.bookingStatus}</p>\r\n                      }\r\n                    {booking.bookingStatus === 'confirmed' ?\r\n                      <div>\r\n                        <button className=\"btn btn-danger\" onClick={()=> cancelTicket(booking._id)}>Cancel Ticket</button>\r\n                      </div>\r\n                    \r\n                    :\r\n                    <></>}\r\n                  </div>\r\n                  )\r\n                })}\r\n                  \r\n              </div>\r\n            </>\r\n          :\r\n            \"\"\r\n          }\r\n        </>\r\n      :\r\n       \"\"\r\n      }\r\n\r\n    </div>\r\n  )\r\n\r\n}\r\n\r\nexport default FlightBookings"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}